student_mat<- read.table("student-mat.csv", header =TRUE, sep = ";", stringsAsFactors = T)
str(student_mat)
student_mat$class<- as.factor("mat")

student_por<- read.table("student-por.csv", header =TRUE, sep=";", stringsAsFactors = T)
student_por$class<- as.factor("por")


student<-rbind(student_mat,student_por)
student<-student[c(1:30,34,31:33)]
student$Performance<-as.factor(ifelse((student$G3>10),("Pass"),("Fail")))
summary(student)

num <- sapply(student, is.numeric)
student_num<-student[,num]
summary(student_num[which(student$class=="mat"),])
summary(student_num[which(student$class=="por"),])

library(tidyverse)
attribute<-c("School","Sex","Age","Address","Family Size","Parent's Status","Mother Education","Father Education","Mother Job","Father Job" ,"Reason","guardian","Time to Travel to School","Weekly Study Time","Past Class Failures","School Educational Support","Family Educational Support"," Extra Paid Class", "Extra Curricular Activities", "Attended Nursery School","Want to Take Higher Education","Internet Access at Home","With a Romantic Relationship","Quality of Family Relationships","Free Time after School","Going out with Friends ","Workday Alcohol Consumption", "Weekend Alcohol Consumption", "Current Health Status","Number of School Absences ","Class", "First Period Grade",  "Secound Period Grade","Final Grade")
for( i in 1:34){
print(ggplot(student,aes(student[,i],fill=Performance))+ geom_bar()+facet_wrap(~class)+xlab(names(student[i]))+xlab(attribute[i]))
}

for( i in c(3,7,8,13,14,24:30,32:34)){
print(ggplot(student,aes(student[,i],fill=class))+ geom_boxplot()+xlab(attribute[i]))
}

library(corrplot)
Student_numeric<-student[,sapply(student,is.numeric)]
mat<-Student_numeric[which(student$class=="mat"),]
por<-Student_numeric[which(student$class=="por"),]

cor_mat<-cor(mat, method = "pearson")
corrplot.mixed(cor_mat,upper ="number",lower="color")

cor_por<-cor(por, method = "pearson")
corrplot.mixed(por,upper ="number",lower="color")
cor_mat_spearman<-cor(mat, method = "spearman")
corrplot.mixed(cor_mat_spearman,upper ="number",lower="color")

cor_por_spearman<-cor(por, method ="spearman")
corrplot.mixed(cor_por_spearman,upper ="number",lower="color")

